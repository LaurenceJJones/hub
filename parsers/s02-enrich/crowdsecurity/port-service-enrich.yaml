filter: evt.Meta.service == 'udp' && evt.Parsed.dst_port != ""
name: crowdsecurity/port-service-enrich-udp
description: "Enrich UDP port with service name"
statics:
  - meta: service_name
    expression: |
      let data = {    "631/udp": "ipp","161/udp": "snmp","137/udp": "netbios-ns","123/udp": "ntp","138/udp": "netbios-dgm","1434/udp": "ms-sql-m","445/udp": "microsoft-ds","135/udp": "msrpc","67/udp": "dhcps","53/udp": "domain","139/udp": "netbios-ssn","500/udp": "isakmp","68/udp": "dhcpc","520/udp": "route","1900/udp": "upnp","4500/udp": "nat-t-ike","514/udp": "syslog","49152/udp": "unknown","162/udp": "snmptrap","69/udp": "tftp","5353/udp": "zeroconf","111/udp": "rpcbind","49154/udp": "unknown","1701/udp": "L2TP","998/udp": "puparp","996/udp": "vsinet","997/udp": "maitrd","999/udp": "applix","3283/udp": "netassistant","49153/udp": "unknown","1812/udp": "radius","136/udp": "profile","2222/udp": "msantipiracy","2049/udp": "nfs","32768/udp": "omad","5060/udp": "sip","1025/udp": "blackjack","1433/udp": "ms-sql-s","3456/udp": "IISrpc-or-vat","80/udp": "http","20031/udp": "bakbonenetvault","1026/udp": "win-rpc","7/udp": "echo","1646/udp": "radacct","1645/udp": "radius","593/udp": "http-rpc-epmap","518/udp": "ntalk","2048/udp": "dls-monitor","626/udp": "serialnumberd","1027/udp": "unknown","177/udp": "xdmcp","1719/udp": "h323gatestat","427/udp": "svrloc","497/udp": "retrospect","8888/tcp": "sun-answerbook","4444/udp": "krb524","1023/udp": "unknown","65024/udp": "unknown","19/udp": "chargen","9/udp": "discard","49193/udp": "unknown","1029/udp": "solid-mux","49/udp": "tacacs","88/udp": "kerberos-sec","1028/udp": "ms-lsa","17185/udp": "wdbrpc","1718/udp": "h225gatedisc","49186/udp": "unknown","2000/udp": "cisco-sccp","31337/udp": "BackOrifice","49201/udp": "unknown","49192/udp": "unknown","515/udp": "printer","2223/udp": "rockwell-csp2","443/udp": "https","49181/udp": "unknown","1813/udp": "radacct","120/udp": "cfdptkt","158/udp": "pcmail-srv","49200/udp": "unknown","3703/udp": "adobeserver-3","32815/udp": "unknown","17/udp": "qotd","5000/udp": "upnp","32771/udp": "sometimes-rpc6","33281/udp": "unknown","1030/udp": "iad1","1022/udp": "exp2","623/udp": "asf-rmcp","32769/udp": "filenet-rpc","5632/udp": "pcanywherestat","10000/udp": "ndmp","49194/udp": "unknown","49191/udp": "unknown","49182/udp": "unknown","49156/udp": "unknown","9200/udp": "wap-wsp","30718/udp": "unknown","49211/udp": "unknown","49190/udp": "unknown"};
      data[evt.Parsed.dst_port+"/"+evt.Meta.service] ?? ""
---
name: crowdsecurity/port-service-enrich-tcp
filter: evt.Meta.service == 'tcp' && evt.Parsed.dst_port != ""
description: "Enrich TCP port with service name"
statics:
  - meta: service_name
    expression: |
      let data = {    "80/tcp": "http",    "23/tcp": "telnet",    "443/tcp": "https",    "21/tcp": "ftp",    "22/tcp": "ssh",    "25/tcp": "smtp",    "3389/tcp": "ms-wbt-server",    "110/tcp": "pop3",    "445/tcp": "microsoft-ds",    "139/tcp": "netbios-ssn",    "143/tcp": "imap",    "53/tcp": "domain",    "135/tcp": "msrpc",    "3306/tcp": "mysql",    "8080/tcp": "http-proxy",    "1723/tcp": "pptp",    "111/tcp": "rpcbind",    "995/tcp": "pop3s",    "993/tcp": "imaps",    "5900/tcp": "vnc",    "1025/tcp": "NFS-or-IIS",    "587/tcp": "submission",    "8888/tcp": "sun-answerbook",    "199/tcp": "smux",    "1720/tcp": "h323q931",    "465/tcp": "smtps",    "548/tcp": "afp",    "113/tcp": "ident",    "81/tcp": "hosts2-ns",    "6001/tcp": "X11:1",    "10000/tcp": "snet-sensor-mgmt",    "514/tcp": "shell",    "5060/tcp": "sip",    "179/tcp": "bgp",    "1026/tcp": "LSA-or-nterm",    "2000/tcp": "cisco-sccp",    "8443/tcp": "https-alt",    "8000/tcp": "http-alt",    "32768/tcp": "filenet-tms",    "554/tcp": "rtsp",    "26/tcp": "rsftp",    "1433/tcp": "ms-sql-s",    "49152/tcp": "unknown",    "2001/tcp": "dc",    "515/tcp": "printer",    "8008/tcp": "http",    "49154/tcp": "unknown",    "1027/tcp": "IIS",    "5666/tcp": "nrpe",    "646/tcp": "ldp",    "5000/tcp": "upnp",    "5631/tcp": "pcanywheredata",    "631/tcp": "ipp",    "49153/tcp": "unknown",    "8081/tcp": "blackice-icecap",    "2049/tcp": "nfs",    "88/tcp": "kerberos-sec",    "79/tcp": "finger",    "5800/tcp": "vnc-http",    "106/tcp": "pop3pw",    "2121/tcp": "ccproxy-ftp",    "1110/tcp": "nfsd-status",    "49155/tcp": "unknown",    "6000/tcp": "X11",    "513/tcp": "login",    "990/tcp": "ftps",    "5357/tcp": "wsdapi",    "427/tcp": "svrloc",    "49156/tcp": "unknown",    "543/tcp": "klogin",    "544/tcp": "kshell",    "5101/tcp": "admdog",    "144/tcp": "news",    "7/tcp": "echo",    "389/tcp": "ldap",    "8009/tcp": "ajp13",    "3128/tcp": "squid-http",    "444/tcp": "snpp",    "9999/tcp": "abyss",    "5009/tcp": "airport-admin",    "7070/tcp": "realserver",    "5190/tcp": "aol",    "3000/tcp": "ppp",    "5432/tcp": "postgresql",    "1900/tcp": "upnp",    "3986/tcp": "mapper-ws_ethd",    "13/tcp": "daytime",    "1029/tcp": "ms-lsa",    "9/tcp": "discard",    "5051/tcp": "ida-agent",    "6646/tcp": "unknown",    "49157/tcp": "unknown",    "1028/tcp": "unknown",    "873/tcp": "rsync",    "1755/tcp": "wms",    "2717/tcp": "pn-requester",    "4899/tcp": "radmin",    "9100/tcp": "jetdirect",    "119/tcp": "nntp",    "37/tcp": "time"};
      data[evt.Parsed.dst_port+"/"+evt.Meta.service] ?? ""