name: crowdsecurity/vpatch-CVE-2025-57819
description: "FreePBX Remote Code Execution (CVE-2025-57819)"
rules:
  - and:
    - zones:
      - URI
      match:
        type: contains
        value: "/admin/ajax.php"
    - zones:
      - ARGS
      variables:
      - module
      transform:
      - urldecode
      match:
        type: contains
        value: "FreePBX\\modules\\endpoint\\ajax"
    - zones:
      - ARGS
      variables:
      - command
      match:
        type: equals
        value: "model"
    - zones:
      - ARGS
      variables:
      - brand
      transform:
      - urldecode
      - lowercase
      match:
        type: regex
        value: "[';]\\s*(insert|update|delete|drop|create|alter)(\\s|/\\*\\*/)*\\s+"
labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "FreePBX Remote Code Execution - CVE-2025-57819"
  classification:
   - cve.CVE-2025-57819
   - attack.T1595
   - attack.T1190
   - attack.T1059
   - cwe.CWE-89
   - cwe.CWE-707

