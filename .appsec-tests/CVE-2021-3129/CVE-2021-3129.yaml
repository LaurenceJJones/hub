id: CVE-2021-3129
info:
  name: CVE-2021-3129
  author: crowdsec
  severity: info
  description: CVE-2021-3129 testing
  tags: appsec-testing
http:
  - raw:
      - |
        POST /_ignition/execute-solution HTTP/1.1
        Host: {{Hostname}}
        Accept: application/json
        Content-Type: application/json

        {"solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution", "parameters": {"variableName": "cve20213129", "viewFile": "php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log"}}
      - |
        POST /_ignition/execute-solution HTTP/1.1
        Host: {{Hostname}}
        Accept: application/json
        Content-Type: application/json

        {"solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution", "parameters": {"variableName": "cve20213129", "viewFile": "phar://../storage/logs/laravel.log/test.txt"}}
      - |
        POST /_ignition/execute-solution HTTP/1.1
        Host: {{Hostname}}
        Accept: application/json
        Content-Type: application/json

        {"solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution", "parameters": {"variableName": "cve20213129", "viewFile": "cGhwOi8vZmlsdGVyL3dyaXRlPWNvbnZlcnQucXVvdGVkLXByaW50YWJsZS1kZWNvZGV8Y29udmVydC5pY29udi51dGYtMTZsZS51dGYtOHxjb252ZXJ0LmJhc2U2NC1kZWNvZGUvcmVzb3VyY2U9Li4vc3RvcmFnZS9sb2dzL2xhcmF2ZWwubG9n"}}
      - |
        POST /_ignition/execute-solution HTTP/1.1
        Host: {{Hostname}}
        Accept: application/json
        Content-Type: application/json

        {"solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution", "parameters": {"variableName": "cve20213129", "viewFile": "cGhhcjovLy4uL3N0b3JhZ2UvbG9ncy9sYXJhdmVsLmxvZy90ZXN0LnR4dA"}}

## cGhwOi8vZmlsdGVyL3dyaXRlPWNvbnZlcnQucXVvdGVkLXByaW50YWJsZS1kZWNvZGV8Y29udmVydC5pY29udi51dGYtMTZsZS51dGYtOHxjb252ZXJ0LmJhc2U2NC1kZWNvZGUvcmVzb3VyY2U9Li4vc3RvcmFnZS9sb2dzL2xhcmF2ZWwubG9n php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log
## cGhhcjovLy4uL3N0b3JhZ2UvbG9ncy9sYXJhdmVsLmxvZy90ZXN0LnR4dA phar://../storage/logs/laravel.log/test.txt
    cookie-reuse: true
#test will fail because we won't match http status 
    matchers:
    - type: status
      status:
       - 403
